version: 2.1
orbs:
    node: circleci/node@1.1.6
jobs:
    build:
        executor:
            name: node/default
        steps:
            - checkout
            - node/with-cache:
                  steps:
                      # Cache yarn packages https://circleci.com/docs/2.0/yarn/
                      - restore_cache:
                            name: Restore Yarn Package Cache
                            keys:
                                - yarn-packages-{{ checksum "yarn.lock" }}
                      - run:
                            name: Yarn install
                            command: yarn install --frozen-lockfile
                      - save_cache:
                            name: Save Yarn Package Cache
                            key: yarn-packages-{{ checksum "yarn.lock" }}
                            paths:
                                - ~/.cache/yarn
                      - run:
                            name: Lint
                            command: yarn lint
                      - run:
                            name: Test
                            command: yarn test
                      - run:
                            name: Build
                            command: yarn build
workflows:
    build-and-test:
        jobs:
            - build
